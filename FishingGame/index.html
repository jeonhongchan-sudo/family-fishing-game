<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ìš°ë¦¬ê°€ì¡± ë‚šì‹œê²Œì„</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ£</text></svg>">
    <style>
        /* ì„¤ì • ë²„íŠ¼ ë° ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
        .settings-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: transparent;
            border: none;
            font-size: 1.5rem;
            color: #94a3b8;
            cursor: pointer;
            z-index: 100;
        }
        .settings-btn:hover { color: #fbbf24; transform: rotate(90deg); transition: transform 0.3s; }
        
        .setting-group { margin-bottom: 20px; text-align: center; }
        .setting-group h3 { margin-bottom: 10px; color: #fbbf24; }
        .difficulty-options { display: flex; gap: 10px; justify-content: center; }
        .diff-btn {
            flex: 1;
            padding: 10px;
            border: 2px solid #475569;
            background: #1e293b;
            color: #94a3b8;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
        }
        .diff-btn.active {
            border-color: #fbbf24;
            background: #451a03;
            color: #fbbf24;
            box-shadow: 0 0 10px rgba(251, 191, 36, 0.3);
        }
        .toggle-btn {
            padding: 10px 30px;
            border-radius: 20px;
            font-weight: bold;
            cursor: pointer;
        }
        .toggle-on { background: #22c55e; color: white; border: none; }
        .toggle-off { background: #ef4444; color: white; border: none; }
    </style>
</head>
<body>
    <div class="game-container">
        <!-- í—¤ë” ë° ìŠ¤íƒ¯ -->
        <header>
            <h1>ğŸ£ ìš°ë¦¬ê°€ì¡± ë‚šì‹œê²Œì„</h1>
            <div class="stats-bar">
                <div class="stat">ğŸ’° <span id="gold">0</span> G</div>
                <div class="stat">â­ Lv.<span id="level">1</span></div>
                <div id="save-indicator" class="stat save-status hidden">ğŸ’¾ ì €ì¥ ì¤‘...</div>
                <div id="user-profile" class="stat hidden">
                    ğŸ‘¤ <span id="username-display"></span>
                    <button id="logout-btn" class="logout-btn">ë¡œê·¸ì•„ì›ƒ</button>
                </div>
                <div class="stat">EXP: <span id="exp">0</span></div>
            </div>
            <button id="settings-btn" class="settings-btn">âš™ï¸</button>
        </header>

        <!-- ë©”ì¸ ê²Œì„ í™”ë©´ -->
        <main>
            <div class="scene">
                <div id="weather-display" class="weather">ë‚ ì”¨: ë§‘ìŒ</div>
                <div id="message-area" class="message-box">
                    <p id="main-message">ë‚šì‹œë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”!</p>
                    <p id="sub-message" class="sub-text">í–‰ìš´ì„ ë¹•ë‹ˆë‹¤.</p>
                </div>
                
                <!-- ì‹œê°ì  ì¥ë©´ (Scene) -->
                <div class="visual-area">
                    <div class="sky"></div>
                    <div class="sea">
                        <div id="bobber" class="bobber hidden">ğŸ”´</div>
                        <div class="wave"></div>
                    </div>
                    <div class="boat-container">
                        <div class="fisherman">ğŸ§‘</div>
                        <div class="boat">ğŸ›¶</div>
                    </div>
                    <!-- ë‚šì‹¯ì¤„ (SVG) -->
                    <svg class="fishing-line-svg">
                        <line id="fishing-line" x1="240" y1="160" x2="240" y2="160" stroke="white" stroke-width="1" />
                    </svg>
                </div>
            </div>

            <!-- ì»¨íŠ¸ë¡¤ íŒ¨ë„ -->
            <div class="controls">
                <!-- ì¼ë°˜ ìƒíƒœ ë²„íŠ¼ -->
                <button id="cast-btn" class="btn primary-btn">
                    <div class="btn-icon">âœ¨</div>
                    <div class="btn-label">ë‚šì‹œí•˜ê¸°</div>
                </button>
                
                <button id="shop-btn" class="btn secondary-btn">
                    <div class="btn-icon">ğŸª</div>
                    <div class="btn-label">ìƒì </div>
                </button>
                <button id="inventory-btn" class="btn secondary-btn">
                    <div class="btn-icon">ğŸ’</div>
                    <div class="btn-label">ê°€ë°©</div>
                </button>
                <button id="ranking-btn" class="btn secondary-btn">
                    <div class="btn-icon">ğŸ†</div>
                    <div class="btn-label">ë­í‚¹</div>
                </button>
                <button id="guide-btn" class="btn secondary-btn">
                    <div class="btn-icon">ğŸ“–</div>
                    <div class="btn-label">ë„ê°</div>
                </button>
            </div>
            <button id="reel-btn" class="btn floating-reel-btn hidden">âœŠ</button>
        </main>

        <!-- ìƒì  ëª¨ë‹¬ -->
        <div id="shop-modal" class="modal hidden">
            <!-- ... (ê¸°ì¡´ ë‚´ìš© ìœ ì§€) ... -->
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ì¥ë¹„ ìƒì </h2>
                    <span class="close-btn" id="close-shop">&times;</span>
                </div>
                <div class="shop-items">
                    <div class="shop-item">
                        <h3>ğŸ£ ë‚šì‹¯ëŒ€ ê°•í™” (Lv.<span id="rod-level">1</span>)</h3>
                        <p id="rod-info">í˜„ì¬: ê¸°ë³¸ ë‚šì‹¯ëŒ€</p>
                        <button id="upgrade-rod-btn" class="btn upgrade-btn">ê°•í™”í•˜ê¸°</button>
                    </div>
                    <div class="shop-item">
                        <h3>ğŸ§µ ë‚šì‹¯ì¤„ ê°•í™” (Lv.<span id="line-level">1</span>)</h3>
                        <p id="line-info">í˜„ì¬: ê¸°ë³¸ ë‚šì‹¯ì¤„</p>
                        <button id="upgrade-line-btn" class="btn upgrade-btn">ê°•í™”í•˜ê¸°</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ë¦´ë§ ê²Œì´ì§€ ì˜¤ë²„ë ˆì´ (ë‚šì‹œ ì¤‘ í‘œì‹œ) -->
        <div id="reeling-overlay" class="reeling-ui hidden">
            <div class="reeling-info">í…ì…˜ì„ <span style="color:#22c55e">ì´ˆë¡ìƒ‰</span>ì— ë§ì¶”ì„¸ìš”!</div>
            
            <!-- ìƒˆë¡œìš´ í…ì…˜ ê²Œì´ì§€ (íŒŒë‘-ì´ˆë¡-ë¹¨ê°•) -->
            <div class="tension-gauge-wrapper">
                <div id="tension-gradient" class="tension-gradient"></div>
                <div id="tension-marker" class="tension-marker">â–¼</div>
                <div id="tension-zone-indicator" class="tension-zone-indicator"></div>
            </div>
            <div class="reeling-status">ê±°ë¦¬: <span id="fish-distance">100</span>m</div>
            <!-- ê±°ë¦¬ ì§„í–‰ë„ ë°” (ë³´ì¡°) -->
            <div class="progress-container small">
                <div id="reeling-bar" class="progress-bar" style="width: 0%"></div>
            </div>
        </div>

        <!-- ì¸ë²¤í† ë¦¬ ëª¨ë‹¬ -->
        <div id="inventory-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ğŸ£ ë¬¼ê³ ê¸° ê°€ë°©</h2>
                    <span class="close-btn" id="close-inventory">&times;</span>
                </div>
                <div id="inventory-list" class="inventory-grid">
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì•„ì´í…œ ì¶”ê°€ë¨ -->
                </div>
            </div>
        </div>

        <!-- ë¬¼ê³ ê¸° íšë“ ëª¨ë‹¬ -->
        <div id="catch-modal" class="modal hidden">
            <div class="modal-content catch-content">
                <h2 id="catch-title">ğŸ‰ ì›”ì²™ì´ë‹¤!</h2>
                <div id="catch-emoji" class="catch-emoji">ğŸŸ</div>
                <div class="catch-details">
                    <h3 id="catch-name">ë¬¼ê³ ê¸° ì´ë¦„</h3>
                    <p><span id="catch-rarity" class="rarity-badge">Common</span></p>
                    <p id="catch-price">ğŸ’° 100 G</p>
                </div>
                <button id="catch-close-btn" class="btn primary-btn">í™•ì¸</button>
            </div>
        </div>

        <!-- ë„ê°(ê°€ì´ë“œ) ëª¨ë‹¬ -->
        <div id="guide-modal" class="modal hidden">
            <div class="modal-content guide-content-wrapper">
                <div class="modal-header">
                    <h2>ğŸ“– ë‚šì‹œ ë„ê°</h2>
                    <span class="close-btn" id="close-guide">&times;</span>
                </div>
                <div class="guide-tabs">
                    <button class="tab-btn active" data-tab="fish">ğŸŸ ì–´ì¢… ì •ë³´</button>
                    <button class="tab-btn" data-tab="equip">ğŸ£ ì¥ë¹„ ì •ë³´</button>
                </div>
                <div id="guide-body" class="guide-body">
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë‚´ìš© ì±„ì›€ -->
                </div>
            </div>
        </div>

        <!-- ë­í‚¹ ëª¨ë‹¬ -->
        <div id="ranking-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>ğŸ† ëª…ì˜ˆì˜ ì „ë‹¹</h2>
                    <span class="close-btn" id="close-ranking">&times;</span>
                </div>
                <div id="ranking-list" class="ranking-list">
                    <!-- ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ë­í‚¹ ì •ë³´ ì¶”ê°€ë¨ -->
                    <div class="ranking-loading">ë­í‚¹ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
                </div>
            </div>
        </div>

        <!-- ì„¤ì • ëª¨ë‹¬ -->
        <div id="settings-modal" class="modal hidden">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>âš™ï¸ ê²Œì„ ì„¤ì •</h2>
                    <span class="close-btn" id="close-settings">&times;</span>
                </div>
                <div class="setting-group">
                    <h3>ğŸ® ë‚œì´ë„ ì„¤ì •</h3>
                    <div class="difficulty-options">
                        <button class="diff-btn" data-diff="EASY">í•˜ (ì‰¬ì›€)<br><span style="font-size:0.7em">ë³´ìƒ 20%</span></button>
                        <button class="diff-btn" data-diff="NORMAL">ì¤‘ (ë³´í†µ)<br><span style="font-size:0.7em">ë³´ìƒ 50%</span></button>
                        <button class="diff-btn active" data-diff="HARD">ìƒ (ì–´ë ¤ì›€)<br><span style="font-size:0.7em">ë³´ìƒ 100%</span></button>
                    </div>
                    <p id="diff-desc" style="margin-top:10px; font-size:0.9rem; color:#ccc;">í˜„ì¬: ìƒ (ê¸°ë³¸ ë‚œì´ë„)</p>
                </div>
                <div class="setting-group">
                    <h3>ğŸ–¼ï¸ ì´ë¯¸ì§€ ëª¨ë“œ</h3>
                    <button id="image-mode-toggle" class="toggle-btn toggle-off">ì´ëª¨ì§€ (Emoji)</button>
                    <p style="margin-top:5px; font-size:0.8rem; color:#94a3b8;">ì‹¤ë¬¼ ì´ë¯¸ì§€ëŠ” ë°ì´í„° ì†Œëª¨ê°€ ìˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                </div>
                <div class="setting-group">
                    <h3>ğŸ“³ ì§„ë™ íš¨ê³¼</h3>
                    <button id="vibration-toggle" class="toggle-btn toggle-on">ì¼œì§ (ON)</button>
                </div>
            </div>
        </div>

        <!-- ì¸ì¦ ëª¨ë‹¬ -->
        <div id="auth-modal" class="modal">
            <div class="modal-content auth-content">
                <div id="auth-view">
                    <!-- ë¡œê·¸ì¸/íšŒì›ê°€ì… í¼ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤. -->
                </div>
                <div id="auth-error" class="auth-error hidden"></div>
            </div>
        </div>
    </div>
    <!-- Supabase JS Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
    <script src="script.js"></script>
    <script src="auth.js"></script>
</body>
</html>